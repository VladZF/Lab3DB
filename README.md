# Бенчмарк python модулей для работы с базами данных

## Оглавление


  - [Оглавление](#оглавление)
  - [1) Про бенчмарк](#1-про-бенчмарк)
  - [2) Настройка конфига](#2-настройка-конфига)
  - [3) Запуск бенчмарка](#3-запуск-бенчмарка)
  - [4) Реализация '4queries' через данный бенчмарк.](#4-реализация-4queries-через-данный-бенчмарк)
    - [Tiny (200 Mb)](#tiny-200-mb)
    - [Big (2 Gb)](#big-2-gb)
  - [5) Про модули](#5-про-модули)
    - [5.1) Psycopg2](#51-psycopg2)
    - [5.2) Pandas](#52-pandas)
    - [5.3) SQLAlchemy](#53-sqlalchemy)
    - [5.4) SQLite](#54-sqlite)
    - [5.5) DuckDB](#55-duckdb)
  - [6) Выводы](#6-выводы)

## 1) Про бенчмарк

Данный бенчмарк представляет собой замеры времени выполнения запросов в различных python модулях для работы с базами данных. Сейчас для теста доступно пять модулей: Psycopg2, pandas, SQLAlchemy, SQLite и DuckDB. Поведение приложения настраивается с помощью специального файла [config.py](https://github.com/VladZF/Lab3DB/blob/master/config.py).

## 2) Настройка конфига

В конфигурационном файле заданы 6 переменных, которые определяют поведение программы в целом.

- DB_PARAMS - данная переменная является python-словарем и содержит в себе параметры для подключения к базе данных. для работы необходимо заполнить пустые значения корректными данными, а вместно ```0``` нужный порт (например ```5432``` для postgresql).

- ATTEMPT_COUNT - количество запусков каждого запроса. Рекомендуемое значение ```20``` для лучшего баланса между точностью среднего времени выполнения запроса и временем работы бенчмарка.

- DATASET - путь к нужному файлу с базой данных (например, путь к .db файлу)

- QUERIES - запросы для тестирования, записанные в виде python-списка в формате ```["""query1""", """query2""", ...]```

- RESULT_FILE_PATH - путь к файлу, куда будут записываться средние времена выполнения запроса в формате
```
<Module> test:
<query 1 time>
<query 2 time>
...
<query 'k' time>
```

- LIB - Python-словарь в формате ```{<module1_name>: True/False, ...}```. True - модуль будет запущен, False - модуль не будет запущен.

## 3) Запуск бенчмарка

После настройки конфигурационного файла, необходимо открыть папку с бенчмарком в консоли и прописать команду ```python main.py```.


## 4) Реализация '4queries' через данный бенчмарк.

Ниже будут приведены замеры с использованием запросов из популярного бенчмарка 4queries, и таблицы trips. Были использованы две версии дата сета:


### Tiny (200 Mb)

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||Pandas|Psycopg2|SQLite|DuckDB|SQLAlchemy|
|Query 1|0,377|0,358|0,948|0,142|0,352|
|Query 2|0,478|0,462|1,644|0,16|0,457|
|Query 3|5,606|5,578|2,791|0,195|5,641|
|Query 4|5,885|5,856|5,708|0,212|6,062|

![Tiny set](E:\Projects\lab3_db\pictures\TinySet.png)

### Big (2 Gb)

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||Pandas|Psycopg2|SQLite|DuckDB|SQLAlchemy|
|Query 1|3,518|3,522|9,539|1,024|3,417|
|Query 2|4,53|4,578|16,172|1,149|4,434|
|Query 3|21,826|59,805|27,87|1,455|58,324|
|Query 4|60,719|62,599|67,272|1,544|61,265|

![Big set](E:\Projects\lab3_db\pictures\BigSet.png)

(Время прописано в секундах).

## 5) Про модули

### 5.1) Psycopg2

### 5.2) Pandas

### 5.3) SQLAlchemy

### 5.4) SQLite

### 5.5) DuckDB

## 6) Выводы